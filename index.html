<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>StaffHealth Stability Index™ Calculator (SHSI)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
:root{
--brand-blue:#1f57b8;
--dark:#111111;
--bg:#f5f5f5;
--card:#ffffff;
--border:#d9d9d9;
--muted:#666;
}
*{box-sizing:border-box;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif}
body{margin:0;background:var(--bg);color:#222}
header{background:var(--dark);color:#fff;text-align:center;padding:28px 15px 18px}
header h1{margin:0;font-size:30px;letter-spacing:1.2px;text-transform:uppercase}
header h1 span{color:var(--brand-blue)}
header p{margin:10px auto 0;max-width:820px;line-height:1.45;font-size:14.5px;color:#e9e9e9}
.hero-strip{background:var(--brand-blue);color:#fff;padding:14px 16px;text-align:center;font-weight:700;text-transform:uppercase;letter-spacing:0.8px;font-size:13px}
.container{max-width:1100px;margin:18px auto 38px;padding:0 15px}
.card{background:var(--card);border-radius:10px;padding:18px 18px 16px;margin-bottom:16px;box-shadow:0 2px 6px rgba(0,0,0,0.06)}
.card h2{margin:0 0 10px;font-size:20px}
.small{font-size:12px;color:var(--muted);line-height:1.45}
.grid{display:grid;gap:14px}
@media(min-width:820px){.grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}}
label{display:block;font-size:13.5px;font-weight:700;margin-bottom:6px}
input[type="text"],input[type="email"],input[type="number"],select,textarea{
width:100%;padding:8px 10px;border-radius:8px;border:1px solid var(--border);font-size:14px;background:#fff
}
textarea{min-height:100px;resize:vertical}
.hint{font-size:12px;color:var(--muted);margin-top:4px}
.btn{border:none;background:var(--brand-blue);color:#fff;padding:10px 16px;border-radius:10px;font-size:14px;font-weight:800;cursor:pointer;text-transform:uppercase;letter-spacing:0.6px}
.btn.secondary{background:#3d3d3d;margin-left:8px}
.mode-toggle{display:flex;gap:18px;align-items:center;flex-wrap:wrap}
.mode-toggle label{font-weight:600;margin:0;display:flex;gap:8px;align-items:center}
.pill{border:1px solid var(--border);border-radius:10px;padding:14px;background:#fff}
.pill h3{margin:0 0 8px;font-size:14px;text-transform:uppercase;letter-spacing:0.6px;color:#2b2b2b}
.opt-row{display:grid;grid-template-columns:1fr 160px;gap:12px;align-items:center;padding:8px 0;border-top:1px dashed #ececec}
.opt-row:first-of-type{border-top:none}
.opt-label{font-size:13px;line-height:1.35;color:#222}
.opt-input{display:flex;gap:8px;align-items:center;justify-content:flex-end}
.opt-input span{font-size:12px;color:var(--muted);white-space:nowrap}
.opt-input input{width:110px;text-align:right}
.totals-line{margin-top:10px;font-size:12px;color:var(--muted)}
.warn{color:#a10000;font-weight:700}
.ok{color:#176b2c;font-weight:700}

/* Results */
.results-banner{background:var(--dark);color:#fff;padding:16px;border-radius:12px;text-align:center}
.results-banner h3{margin:0 0 10px;font-size:18px}
.results-row{display:flex;flex-wrap:wrap;gap:12px;justify-content:center}
.result-pill{flex:1 1 180px;min-width:180px;background:#1c1c1c;border-radius:12px;padding:12px 10px;text-align:center}
.result-label{font-size:11px;text-transform:uppercase;color:#bfbfbf;letter-spacing:0.6px}
.result-value{margin-top:6px;font-size:22px;font-weight:900;color:#e0ecff}
.badge{display:inline-block;margin-top:8px;padding:4px 10px;border-radius:999px;font-size:11px;font-weight:800}
.b-low{background:#d4f5d4;color:#176b2c}
.b-med{background:#fff2c6;color:#8a5b00}
.b-high{background:#ffd3d3;color:#a10000}

.pill-header{font-weight:900;font-size:12px;text-transform:uppercase;letter-spacing:0.6px;color:#444;margin-bottom:6px}
.big-impact{font-size:15px;font-weight:900;margin-bottom:4px}
.big-impact span{font-weight:950}
footer{text-align:center;font-size:12px;color:#888;padding:20px 10px 30px}
</style>
</head>

<body>
<header>
<h1><span>StaffHealth</span> Stability Index™</h1>
<p>
Directional diagnostic that scores staffing “health” across 10 volatility drivers — census, OT, PBJ, survey exposure,
reimbursement, reputation, and leadership bandwidth. Designed for a single building or an entire portfolio.
</p>
</header>

<div class="hero-strip">Single Community Mode or Portfolio Mode — same 10 questions, different interface.</div>

<div class="container">

<div class="card">
<h2>1. Select Mode</h2>
<div class="mode-toggle">
<label><input type="radio" name="mode" value="single" checked> Single Community Mode (ED / building-level)</label>
<label><input type="radio" name="mode" value="portfolio"> Portfolio Mode (VP Ops / portfolio roll-up)</label>
</div>
<div class="hint" style="margin-top:8px;">
Portfolio Mode lets executives estimate how many communities sit in each answer option for each question — no need to run 20 buildings one-by-one.
</div>
</div>

<div class="card">
<h2>2. Snapshot</h2>
<div class="grid grid-2">
<div>
<label for="communityType">Primary Care Level (dominant)</label>
<select id="communityType">
<option value="al_mc" selected>Assisted Living / Memory Care</option>
<option value="snf">Skilled Nursing / Rehab (PDPM)</option>
<option value="mixed">Mixed Campus (AL/MC + SNF)</option>
</select>
<div class="hint">Used to tailor PDPM / reimbursement relevance.</div>
</div>
<div>
<label for="state">State / Region (optional)</label>
<input id="state" type="text" placeholder="TX, GA, FL, etc." />
<div class="hint">Optional context for follow-up discussion.</div>
</div>
</div>
</div>

<!-- SINGLE MODE -->
<div class="card" id="singleSection">
<h2>3. Single Community Risk Profile</h2>
<p class="small" style="margin-bottom:12px;">
Choose the option that best fits today. If you’re not sure, select <b>Unknown / Not sure</b> — lack of visibility is itself a risk.
</p>

<div class="grid grid-2">
<div>
<label for="q1">Census stability &amp; move-in / move-out patterns</label>
<select id="q1">
<option value="low">Generally stable, rarely delayed</option>
<option value="med">Some seasonal swings or occasional delays</option>
<option value="high">Frequent delays, hard to keep census steady</option>
<option value="unk">Unknown / Not sure</option>
</select>
</div>

<div>
<label for="q2">Acuity shifts &amp; ability to flex staffing</label>
<select id="q2">
<option value="low">Acuity fairly stable, model flexes well</option>
<option value="med">Occasional spikes strain the team</option>
<option value="high">Frequent acuity spikes; team constantly stretched</option>
<option value="unk">Unknown / Not sure</option>
</select>
</div>

<div>
<label for="q3">Labor model &amp; overtime / call-out pressure</label>
<select id="q3">
<option value="low">Low (0–20 OT hours/month; call-outs manageable)</option>
<option value="med">Moderate (20–60 OT hours/month or frequent scrambling)</option>
<option value="high">High (60+ OT hours/month; daily scrambling / heavy OT)</option>
<option value="unk">Unknown / Not sure</option>
</select>
<div class="hint">Overtime ranges are monthly, across roles.</div>
</div>

<div>
<label for="q4">Survey / regulatory comfort level</label>
<select id="q4">
<option value="low">Clean recent history, few staffing concerns</option>
<option value="med">Some tags or close calls tied to staffing</option>
<option value="high">Significant survey risk or recent citations</option>
<option value="unk">Unknown / Not sure</option>
</select>
</div>

<div>
<label for="q5">Reimbursement &amp; documentation (for SNF/PDPM beds)</label>
<select id="q5">
<option value="low">Documentation strong; denials are rare</option>
<option value="med">Occasional denials or missed skilled minutes</option>
<option value="high">Frequent corrections, denials, or missed minutes</option>
<option value="unk">Unknown / Not sure / Not applicable</option>
</select>
</div>

<div>
<label for="q6">Liability exposure (falls, med errors, incidents)</label>
<select id="q6">
<option value="low">Incidents infrequent and well managed</option>
<option value="med">Moderate incident volume with some staffing link</option>
<option value="high">High incident volume or recent severe events</option>
<option value="unk">Unknown / Not sure</option>
</select>
</div>

<div>
<label for="q7">Reputation &amp; referral velocity</label>
<select id="q7">
<option value="low">Strong reviews and referral relationships</option>
<option value="med">Mixed reviews or stalled referrals</option>
<option value="high">Negative staffing-related reviews or referral pullback</option>
<option value="unk">Unknown / Not sure</option>
</select>
</div>

<div>
<label for="q8">Leadership bandwidth (ED/DON time spent on staffing)</label>
<select id="q8">
<option value="low">Staffing rarely hijacks leadership time</option>
<option value="med">Staffing issues consume weekly time blocks</option>
<option value="high">Leaders feel constantly pulled into staffing fires</option>
<option value="unk">Unknown / Not sure</option>
</select>
</div>

<div>
<label for="q9">Corporate standardization (partners &amp; credentialing)</label>
<select id="q9">
<option value="low">Single, well-aligned partner &amp; clear process</option>
<option value="med">Several partners with some variation</option>
<option value="high">Many partners; processes and quality vary widely</option>
<option value="unk">Unknown / Not sure</option>
</select>
</div>

<div>
<label for="q10">PBJ accuracy &amp; Five-Star staffing confidence</label>
<select id="q10">
<option value="low">PBJ clean; confident in staffing data</option>
<option value="med">Some corrections or PBJ-related anxiety</option>
<option value="high">Frequent corrections, dips, or staffing-star concerns</option>
<option value="unk">Unknown / Not sure</option>
</select>
</div>
</div>

<div style="margin-top:16px;">
<label for="usageLevel">If you used StaffHealth as an elasticity layer, how broadly would you expect to use us?</label>
<select id="usageLevel" style="max-width:380px;">
<option value="conservative">Conservative (weekends, true pain points only)</option>
<option value="moderate" selected>Moderate (weekends + select dayparts)</option>
<option value="aggressive">Strategic (full elasticity model across the building)</option>
</select>
<div class="hint">This adjusts the projected stability gain (risk reduction).</div>
</div>

<div style="margin-top:18px;">
<h3 style="margin:0 0 8px;font-size:15px;">Rate &amp; Hours Snapshot (Optional)</h3>
<p class="small">
Add a simple comparison rate and expected hours if you want the tool to incorporate direct rate economics.
Leave blank to run a pure volatility/risk view.
</p>
<div class="grid grid-2">
<div>
<label for="compareRate">Comparison hourly / blended rate ($/hr)</label>
<input id="compareRate" type="number" step="0.01" placeholder="e.g., 52.00" />
</div>
<div>
<label for="staffRate">StaffHealth proposed hourly / blended rate ($/hr)</label>
<input id="staffRate" type="number" step="0.01" placeholder="e.g., 49.00" />
</div>
<div>
<label for="hoursMonth">Estimated hours per month through StaffHealth</label>
<input id="hoursMonth" type="number" step="1" placeholder="e.g., 200" />
</div>
</div>
</div>
</div>

<!-- PORTFOLIO MODE (NEW UX) -->
<div class="card" id="portfolioSection" style="display:none;">
<h2>3. Portfolio Risk Profile (All Communities)</h2>
<p class="small" style="margin-bottom:10px;">
For each question, enter how many communities in your portfolio match each option. This creates a portfolio-level view without running the tool community-by-community.
</p>

<div class="grid grid-2" style="margin-bottom:10px;">
<div>
<label for="portfolioN">Portfolio size (optional)</label>
<input id="portfolioN" type="number" min="0" placeholder="e.g., 18" />
<div class="hint">If provided, we’ll flag questions where your counts don’t sum to N (sanity check only).</div>
</div>
<div>
<label for="usageLevelPortfolio">Elasticity adoption level (portfolio)</label>
<select id="usageLevelPortfolio">
<option value="conservative">Conservative (weekends / true pain points)</option>
<option value="moderate" selected>Moderate (weekends + select dayparts)</option>
<option value="aggressive">Strategic (broad portfolio elasticity)</option>
</select>
<div class="hint">Adjusts projected risk reduction across the portfolio.</div>
</div>
</div>

<!-- Helper note -->
<div class="pill" style="margin-bottom:12px;">
<h3>How to use</h3>
<div class="small">
For each factor, estimate how many communities fit each option. If unsure for a subset, place them in <b>Unknown</b>.
The tool uses conservative scoring where “unknown” increases risk due to lack of visibility.
</div>
</div>

<!-- Question blocks -->
<div class="pill" data-q="q1">
<h3>1) Census stability &amp; move-in / move-out patterns</h3>
<div class="opt-row">
<div class="opt-label">Generally stable, rarely delayed</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q1_low"></div>
</div>
<div class="opt-row">
<div class="opt-label">Some seasonal swings or occasional delays</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q1_med"></div>
</div>
<div class="opt-row">
<div class="opt-label">Frequent delays, hard to keep census steady</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q1_high"></div>
</div>
<div class="opt-row">
<div class="opt-label">Unknown / Not sure</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q1_unk"></div>
</div>
<div class="totals-line" id="sum_q1"></div>
</div>

<div class="pill" data-q="q2" style="margin-top:12px;">
<h3>2) Acuity shifts &amp; ability to flex staffing</h3>
<div class="opt-row">
<div class="opt-label">Acuity fairly stable, model flexes well</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q2_low"></div>
</div>
<div class="opt-row">
<div class="opt-label">Occasional spikes strain the team</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q2_med"></div>
</div>
<div class="opt-row">
<div class="opt-label">Frequent acuity spikes; team constantly stretched</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q2_high"></div>
</div>
<div class="opt-row">
<div class="opt-label">Unknown / Not sure</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q2_unk"></div>
</div>
<div class="totals-line" id="sum_q2"></div>
</div>

<div class="pill" data-q="q3" style="margin-top:12px;">
<h3>3) Labor model &amp; overtime / call-out pressure</h3>
<div class="opt-row">
<div class="opt-label">Low (0–20 OT hours/month; call-outs manageable)</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q3_low"></div>
</div>
<div class="opt-row">
<div class="opt-label">Moderate (20–60 OT hours/month or frequent scrambling)</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q3_med"></div>
</div>
<div class="opt-row">
<div class="opt-label">High (60+ OT hours/month; daily scrambling / heavy OT)</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q3_high"></div>
</div>
<div class="opt-row">
<div class="opt-label">Unknown / Not sure</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q3_unk"></div>
</div>
<div class="totals-line" id="sum_q3"></div>
</div>

<div class="pill" data-q="q4" style="margin-top:12px;">
<h3>4) Survey / regulatory comfort level</h3>
<div class="opt-row">
<div class="opt-label">Clean recent history, few staffing concerns</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q4_low"></div>
</div>
<div class="opt-row">
<div class="opt-label">Some tags or close calls tied to staffing</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q4_med"></div>
</div>
<div class="opt-row">
<div class="opt-label">Significant survey risk or recent citations</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q4_high"></div>
</div>
<div class="opt-row">
<div class="opt-label">Unknown / Not sure</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q4_unk"></div>
</div>
<div class="totals-line" id="sum_q4"></div>
</div>

<div class="pill" data-q="q5" style="margin-top:12px;">
<h3>5) Reimbursement &amp; documentation (for SNF/PDPM beds)</h3>
<div class="opt-row">
<div class="opt-label">Documentation strong; denials are rare</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q5_low"></div>
</div>
<div class="opt-row">
<div class="opt-label">Occasional denials or missed skilled minutes</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q5_med"></div>
</div>
<div class="opt-row">
<div class="opt-label">Frequent corrections, denials, or missed minutes</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q5_high"></div>
</div>
<div class="opt-row">
<div class="opt-label">Unknown / Not sure / Not applicable</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q5_unk"></div>
</div>
<div class="totals-line" id="sum_q5"></div>
</div>

<div class="pill" data-q="q6" style="margin-top:12px;">
<h3>6) Liability exposure (falls, med errors, incidents)</h3>
<div class="opt-row">
<div class="opt-label">Incidents infrequent and well managed</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q6_low"></div>
</div>
<div class="opt-row">
<div class="opt-label">Moderate incident volume with some staffing link</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q6_med"></div>
</div>
<div class="opt-row">
<div class="opt-label">High incident volume or recent severe events</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q6_high"></div>
</div>
<div class="opt-row">
<div class="opt-label">Unknown / Not sure</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q6_unk"></div>
</div>
<div class="totals-line" id="sum_q6"></div>
</div>

<div class="pill" data-q="q7" style="margin-top:12px;">
<h3>7) Reputation &amp; referral velocity</h3>
<div class="opt-row">
<div class="opt-label">Strong reviews and referral relationships</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q7_low"></div>
</div>
<div class="opt-row">
<div class="opt-label">Mixed reviews or stalled referrals</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q7_med"></div>
</div>
<div class="opt-row">
<div class="opt-label">Negative staffing-related reviews or referral pullback</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q7_high"></div>
</div>
<div class="opt-row">
<div class="opt-label">Unknown / Not sure</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q7_unk"></div>
</div>
<div class="totals-line" id="sum_q7"></div>
</div>

<div class="pill" data-q="q8" style="margin-top:12px;">
<h3>8) Leadership bandwidth (ED/DON time spent on staffing)</h3>
<div class="opt-row">
<div class="opt-label">Staffing rarely hijacks leadership time</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q8_low"></div>
</div>
<div class="opt-row">
<div class="opt-label">Staffing issues consume weekly time blocks</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q8_med"></div>
</div>
<div class="opt-row">
<div class="opt-label">Leaders feel constantly pulled into staffing fires</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q8_high"></div>
</div>
<div class="opt-row">
<div class="opt-label">Unknown / Not sure</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q8_unk"></div>
</div>
<div class="totals-line" id="sum_q8"></div>
</div>

<div class="pill" data-q="q9" style="margin-top:12px;">
<h3>9) Corporate standardization (partners &amp; credentialing)</h3>
<div class="opt-row">
<div class="opt-label">Single, well-aligned partner &amp; clear process</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q9_low"></div>
</div>
<div class="opt-row">
<div class="opt-label">Several partners with some variation</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q9_med"></div>
</div>
<div class="opt-row">
<div class="opt-label">Many partners; processes and quality vary widely</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q9_high"></div>
</div>
<div class="opt-row">
<div class="opt-label">Unknown / Not sure</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q9_unk"></div>
</div>
<div class="totals-line" id="sum_q9"></div>
</div>

<div class="pill" data-q="q10" style="margin-top:12px;">
<h3>10) PBJ accuracy &amp; Five-Star staffing confidence</h3>
<div class="opt-row">
<div class="opt-label">PBJ clean; confident in staffing data</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q10_low"></div>
</div>
<div class="opt-row">
<div class="opt-label">Some corrections or PBJ-related anxiety</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q10_med"></div>
</div>
<div class="opt-row">
<div class="opt-label">Frequent corrections, dips, or staffing-star concerns</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q10_high"></div>
</div>
<div class="opt-row">
<div class="opt-label">Unknown / Not sure</div>
<div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q10_unk"></div>
</div>
<div class="totals-line" id="sum_q10"></div>
</div>

</div>

<div class="card">
<h2>4. Run the SHSI</h2>
<p class="small">Click Calculate to see SHSI score, projected stability gain, and illustrative annual economics.</p>
<button class="btn" id="calcBtn">Calculate SHSI</button>
<button class="btn secondary" id="resetBtn" type="button">Reset</button>
</div>

<div class="card" id="resultsCard" style="display:none;">
<div class="results-banner">
<h3>Your StaffHealth Stability Index™ Snapshot</h3>
<div class="results-row">
<div class="result-pill">
<div class="result-label" id="riskLabel">Operator Risk Burden (Pre-StaffHealth)</div>
<div class="result-value" id="riskScoreLabel">0 / 100</div>
<div id="riskBadge" class="badge"></div>
</div>
<div class="result-pill">
<div class="result-label">Projected Stability Gain (Elasticity Impact)</div>
<div class="result-value" id="impactScoreLabel">0 pts</div>
<div class="small" style="color:#bfbfbf;">How many risk points a StaffHealth + Verified model could realistically remove.</div>
</div>
<div class="result-pill">
<div class="result-label">Stabilized SHSI (Post-StaffHealth)</div>
<div class="result-value" id="finalScoreLabel">0 / 100</div>
<div class="small" style="color:#bfbfbf;">Lower is better — post-elasticity risk profile.</div>
</div>
</div>
</div>

<p class="small" id="modeSummary" style="margin-top:12px;">
The SHSI is a directional tool, not a survey or audit. It is designed to open a deeper conversation about where volatility, overtime, PBJ, and survey exposure are silently taxing operations.
</p>

<div class="grid grid-2" style="margin-top:12px;">
<div>
<div class="pill-header">Estimated Annual Economics at Stake (Illustrative)</div>
<div id="valueSummary">—</div>
</div>
<div>
<div class="pill-header">Quick Read on Staffing Health</div>
<div id="profileSummary" class="small" style="font-size:13px;color:#333;">—</div>
</div>
</div>

<div style="margin-top:12px;">
<div class="pill-header">Rate & Model Narrative</div>
<div id="rateNarrative" class="small" style="font-size:13px;color:#333;">—</div>
</div>
</div>

<div class="card" id="followupCard" style="display:none;">
<h2>5. Copyable Summary (Optional)</h2>
<p class="small">Copy results into an email, CRM note, or text.</p>
<label for="resultsText">Copyable SHSI Summary</label>
<textarea id="resultsText"></textarea>
<button class="btn" type="button" id="copyBtn" style="margin-top:10px;">Copy Results</button>
</div>

</div>

<footer>StaffHealth + Accushield Verified — StaffHealth Stability Index™ (SHSI) Calculator — Prototype</footer>

<script>
const WEIGHTS = { q1:12, q2:10, q3:14, q4:12, q5:10, q6:12, q7:8, q8:10, q9:6, q10:10 };

function getMode(){
const el=document.querySelector('input[name="mode"]:checked');
return el?el.value:"single";
}

function riskFromAnswer(val){
switch(val){
case "low": return 0.2;
case "med": return 0.5;
case "high": return 0.8;
case "unk": return 1.0;
default: return 0.5;
}
}

function classify(score100){
if(score100 < 40) return {label:"Low Volatility", cls:"b-low"};
if(score100 < 70) return {label:"Moderate Volatility", cls:"b-med"};
return {label:"High Volatility", cls:"b-high"};
}

function usageImpactPct(val){
if(val==="conservative") return 0.35;
if(val==="aggressive") return 0.65;
return 0.50; // moderate default
}

function intVal(id){
const v = parseInt((document.getElementById(id)?.value || "0"), 10);
return isNaN(v) ? 0 : v;
}

function sumPortfolioRow(qKey){
const low=intVal(`p_${qKey}_low`);
const med=intVal(`p_${qKey}_med`);
const high=intVal(`p_${qKey}_high`);
const unk=intVal(`p_${qKey}_unk`);
return {low,med,high,unk,total: low+med+high+unk};
}

function updateRowSums(){
const N = intVal("portfolioN");
for(let i=1;i<=10;i++){
const qKey="q"+i;
const s = sumPortfolioRow(qKey);
const el = document.getElementById("sum_"+qKey);
if(!el) continue;

if(s.total===0){
el.innerHTML = `<span class="small">Total entered: 0 (optional)</span>`;
continue;
}

if(N>0){
if(s.total===N){
el.innerHTML = `<span class="ok">Total entered: ${s.total} (matches portfolio size)</span>`;
}else{
el.innerHTML = `<span class="warn">Total entered: ${s.total} (does not match portfolio size ${N})</span>`;
}
}else{
el.innerHTML = `<span class="small">Total entered: ${s.total}</span>`;
}
}
}

// Live sum updates in portfolio mode
["portfolioN",
"p_q1_low","p_q1_med","p_q1_high","p_q1_unk",
"p_q2_low","p_q2_med","p_q2_high","p_q2_unk",
"p_q3_low","p_q3_med","p_q3_high","p_q3_unk",
"p_q4_low","p_q4_med","p_q4_high","p_q4_unk",
"p_q5_low","p_q5_med","p_q5_high","p_q5_unk",
"p_q6_low","p_q6_med","p_q6_high","p_q6_unk",
"p_q7_low","p_q7_med","p_q7_high","p_q7_unk",
"p_q8_low","p_q8_med","p_q8_high","p_q8_unk",
"p_q9_low","p_q9_med","p_q9_high","p_q9_unk",
"p_q10_low","p_q10_med","p_q10_high","p_q10_unk"
].forEach(id=>{
const el=document.getElementById(id);
if(el) el.addEventListener("input", updateRowSums);
});

// Toggle behavior
document.querySelectorAll('input[name="mode"]').forEach(r=>{
r.addEventListener("change", ()=>{
const mode=getMode();
document.getElementById("singleSection").style.display = mode==="single" ? "block" : "none";
document.getElementById("portfolioSection").style.display = mode==="portfolio" ? "block" : "none";

document.getElementById("riskLabel").textContent =
mode==="single" ? "Operator Risk Burden (Pre-StaffHealth)" : "Average Risk Burden per Community (Portfolio)";

document.getElementById("modeSummary").textContent =
mode==="single"
? "In Single Community Mode, the SHSI reflects one building’s volatility, overtime, PBJ exposure, and leadership strain. It is directional, not a survey or audit."
: "In Portfolio Mode, the SHSI reflects an average per-community risk profile based on how many communities fit each answer option for each factor.";

if(mode==="portfolio") updateRowSums();
});
});

document.getElementById("calcBtn").addEventListener("click", ()=>{
const mode=getMode();
const communityType=document.getElementById("communityType").value;
const state=document.getElementById("state").value || "N/A";

let weights={...WEIGHTS};
if(communityType==="al_mc") weights.q5 = 0;

let riskScore100=0, impactScore=0, finalScore=0;
let baselineLow=0, baselineHigh=0, stabilizedLow=0, stabilizedHigh=0;
let netImpact=0, directAnnual=0, hasRates=false;
let usedN=1;

if(mode==="single"){
let weightedSum=0, weightTotal=0;

for(let i=1;i<=10;i++){
const key="q"+i;
const w=weights[key];
if(w===0) continue;
const ans=document.getElementById(key).value;
const r=riskFromAnswer(ans); // 0–1
weightedSum += (r*10) * w; // 0–10 scaled
weightTotal += w;
}

const riskScore = weightTotal===0 ? 0 : (weightedSum/weightTotal); // 0–10
riskScore100 = Math.round(riskScore*10);

const usage=document.getElementById("usageLevel").value;
const impactPct=usageImpactPct(usage);
impactScore = Math.round(riskScore100 * impactPct);
finalScore = Math.max(0, riskScore100 - impactScore);

// Illustrative econ ranges
baselineLow = Math.round(riskScore100*3000/1000)*1000;
baselineHigh = Math.round(riskScore100*6000/1000)*1000;
stabilizedLow = Math.round(impactScore*3000/1000)*1000;
stabilizedHigh = Math.round(impactScore*6000/1000)*1000;

// Optional rates
const compareRate=parseFloat(document.getElementById("compareRate").value);
const staffRate=parseFloat(document.getElementById("staffRate").value);
const hoursMonth=parseFloat(document.getElementById("hoursMonth").value);

hasRates = !isNaN(compareRate)&&compareRate>0 && !isNaN(staffRate)&&staffRate>0 && !isNaN(hoursMonth)&&hoursMonth>0;

const stabilizedMid = (stabilizedLow + stabilizedHigh)/2;
if(hasRates){
directAnnual = (compareRate - staffRate) * hoursMonth * 12; // + = savings
netImpact = stabilizedMid + directAnnual;
}else{
netImpact = stabilizedMid;
}
usedN=1;

}else{
// PORTFOLIO MODE — counts next to each option
let weightedSum=0, weightTotal=0;
let totalNsum=0, qCount=0;

for(let i=1;i<=10;i++){
const key="q"+i;
const w=weights[key];
if(w===0) continue;

const s=sumPortfolioRow(key);
if(s.total===0) continue;

// risk avg for this factor
const r = (0.2*s.low + 0.5*s.med + 0.8*s.high + 1.0*s.unk) / s.total; // 0–1
weightedSum += (r*10) * w;
weightTotal += w;

totalNsum += s.total;
qCount++;
}

const riskScore = weightTotal===0 ? 0 : (weightedSum/weightTotal); // 0–10
riskScore100 = Math.round(riskScore*10);

// Estimate N as average across questions that were filled
usedN = qCount>0 ? Math.round(totalNsum/qCount) : 1;

const usage=document.getElementById("usageLevelPortfolio").value;
const impactPct=usageImpactPct(usage);
impactScore = Math.round(riskScore100 * impactPct);
finalScore = Math.max(0, riskScore100 - impactScore);

// Econ ranges per building, then scale by N
const perLow = Math.round(riskScore100*3000/1000)*1000;
const perHigh = Math.round(riskScore100*6000/1000)*1000;
const perStabLow = Math.round(impactScore*3000/1000)*1000;
const perStabHigh = Math.round(impactScore*6000/1000)*1000;

baselineLow = perLow * usedN;
baselineHigh = perHigh * usedN;
stabilizedLow = perStabLow * usedN;
stabilizedHigh = perStabHigh * usedN;

netImpact = (stabilizedLow + stabilizedHigh)/2;
hasRates=false;
}

// Render results
document.getElementById("riskScoreLabel").textContent = `${riskScore100} / 100`;
document.getElementById("impactScoreLabel").textContent = `${impactScore} pts`;
document.getElementById("finalScoreLabel").textContent = `${finalScore} / 100`;

const b=classify(riskScore100);
const badge=document.getElementById("riskBadge");
badge.textContent=b.label;
badge.className=`badge ${b.cls}`;

// Money summary
const baselineText = mode==="single"
? `Annual economics currently influenced by staffing volatility: <span>$${baselineLow.toLocaleString()}–$${baselineHigh.toLocaleString()}</span>`
: `Portfolio annual economics currently influenced by staffing volatility (≈${usedN} communities): <span>$${baselineLow.toLocaleString()}–$${baselineHigh.toLocaleString()}</span>`;

const stabText = mode==="single"
? `Illustrative economics a StaffHealth + Accushield Verified model could help stabilize: <b>$${stabilizedLow.toLocaleString()}–$${stabilizedHigh.toLocaleString()}</b>`
: `Illustrative economics a StaffHealth + Accushield Verified model could help stabilize (portfolio): <b>$${stabilizedLow.toLocaleString()}–$${stabilizedHigh.toLocaleString()}</b>`;

let extra = "";
if(mode==="single"){
if(hasRates){
const directLabel = directAnnual >= 0 ? "Estimated direct annual savings from rate:" : "Estimated direct annual premium from rate:";
const netLabel = netImpact >= 0 ? "Directional annual net benefit (rate + stability):" : "Directional annual net cost (rate + stability):";
extra = `<div class="small" style="margin-top:8px;">
<b>${directLabel}</b> $${Math.abs(directAnnual).toLocaleString()}<br/>
<b>${netLabel}</b> $${Math.abs(netImpact).toLocaleString()}
</div>`;
}else{
extra = `<div class="small" style="margin-top:8px;">Rate fields were left blank, so this view focuses on volatility and risk rather than hourly pricing.</div>`;
}
}else{
extra = `<div class="small" style="margin-top:8px;">Portfolio Mode uses your distribution of communities across each option for each factor to compute an average risk score per community and a portfolio roll-up.</div>`;
}

document.getElementById("valueSummary").innerHTML =
`<div class="big-impact">${baselineText}</div><div>${stabText}</div>${extra}`;

// Profile narrative
let profile="";
if(riskScore100 < 40){
profile = (mode==="single")
? "Low volatility today. The opportunity is to protect stability as census/acuity evolve, especially around weekends and PBJ."
: "Portfolio trends low volatility on average. The opportunity is to protect stability while targeting the subset of communities trending into higher risk.";
}else if(riskScore100 < 70){
profile = (mode==="single")
? "Moderate volatility: things work, but leaders feel the strain. A targeted elasticity layer on weekends and pain shifts can reduce OT and survey stress."
: "Moderate volatility across the portfolio: operations work, but leadership is absorbing real OT/PBJ/schedule pressure. A structured elasticity layer across the right subset can move the average meaningfully.";
}else{
profile = (mode==="single")
? "Higher volatility: leadership, PBJ, and census are likely absorbing hidden costs weekly. A verified elasticity model can materially reduce risk and restore capacity."
: "Higher volatility across the portfolio: multiple buildings likely absorb hidden cost weekly in OT, PBJ, survey readiness, and leadership time. A verified elasticity model deployed across the right cohort can materially reduce downside risk.";
}
document.getElementById("profileSummary").textContent = profile;

// Rate narrative
let rateNarr="";
if(mode==="portfolio"){
rateNarr = "This run focuses on volatility and risk at the portfolio level. In follow-up, we can layer in rate cohorts (agency vs OT vs blended) to show how the model behaves financially by building cluster. Core message: volatility and compliance exposure often cost more than the rate line.";
}else{
if(!hasRates){
rateNarr = "No rate inputs were provided, so this run is a pure volatility/risk view. Add rate + hours to compare direct economics alongside the stability benefit.";
}else{
const compareRate=parseFloat(document.getElementById("compareRate").value);
const staffRate=parseFloat(document.getElementById("staffRate").value);
const premium = staffRate > compareRate + 1;
const parity = Math.abs(staffRate-compareRate) <= 1;
const cheaper = staffRate < compareRate - 1;

if(cheaper && netImpact>=0){
rateNarr = "Rate and risk both work in your favor. StaffHealth improves hourly economics and stabilizes volatility exposure — strong pilot profile.";
}else if(parity && netImpact>=0){
rateNarr = "Rate parity shifts the conversation to volatility: the upside lives in PBJ, survey readiness, leadership time, and reduced OT churn.";
}else if(premium && netImpact>=0){
rateNarr = "Even with a rate premium, the estimated stability benefit outweighs it — trading a known small cost for a larger reduction in volatility and downside risk.";
}else{
rateNarr = "On these specific inputs the financial signal is weak. Worth revisiting if hours mix, comparison rate, or volatility picture changes.";
}
}
}
document.getElementById("rateNarrative").textContent = rateNarr;

// Copy block
let copy =
`StaffHealth Stability Index™ (SHSI) – Results\n\n` +
`Mode: ${mode==="single" ? "Single Community" : "Portfolio"}\n` +
`Community Type: ${communityType.toUpperCase()}\n` +
`State/Region: ${state}\n\n` +
`SHSI Risk Score (Pre-StaffHealth): ${riskScore100} / 100\n` +
`Projected Stability Gain (Elasticity Impact): ${impactScore} pts\n` +
`Stabilized SHSI (Post-StaffHealth): ${finalScore} / 100\n\n` +
`Annual economics influenced by staffing volatility: $${baselineLow.toLocaleString()}–$${baselineHigh.toLocaleString()}\n` +
`Illustrative economics StaffHealth + Verified could help stabilize: $${stabilizedLow.toLocaleString()}–$${stabilizedHigh.toLocaleString()}\n\n`;

if(mode==="portfolio"){
copy += `Approx. portfolio size used (avg of filled questions): ${usedN}\n`;
}

document.getElementById("resultsText").value = copy;

document.getElementById("resultsCard").style.display="block";
document.getElementById("followupCard").style.display="block";
document.getElementById("resultsCard").scrollIntoView({behavior:"smooth"});
});

document.getElementById("resetBtn").addEventListener("click", ()=>{
// single resets
for(let i=1;i<=10;i++){
const s=document.getElementById("q"+i);
if(s) s.selectedIndex=0;
}
document.getElementById("usageLevel").value="moderate";
["compareRate","staffRate","hoursMonth","state"].forEach(id=>document.getElementById(id).value="");

// portfolio resets
document.getElementById("portfolioN").value="";
document.getElementById("usageLevelPortfolio").value="moderate";
for(let i=1;i<=10;i++){
["low","med","high","unk"].forEach(b=>{
const el=document.getElementById(`p_q${i}_${b}`);
if(el) el.value="";
});
const sumEl=document.getElementById("sum_q"+i);
if(sumEl) sumEl.textContent="";
}

document.getElementById("resultsCard").style.display="none";
document.getElementById("followupCard").style.display="none";
});

document.getElementById("copyBtn").addEventListener("click", function(){
const ta=document.getElementById("resultsText");
ta.select();
ta.setSelectionRange(0,99999);
try{
document.execCommand("copy");
this.textContent="Copied!";
setTimeout(()=>this.textContent="Copy Results",1200);
}catch(e){
alert("Copy failed. Please select and copy manually.");
}
});

// initialize sums if they switch modes quickly
updateRowSums();
</script>
</body>
</html>
