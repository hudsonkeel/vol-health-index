<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>VOL Health™ Volatility Index</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
:root{
  /* Shared brand colors (match landing page) */
  --brand-blue:#1f57b8;        /* StaffHealth blue */
  --brand-green:#2e8b57;       /* Accushield Verified green */
  --brand-yellow:#f2b705;

  /* Core theme (copied from landing page) */
  --dark:#050814;
  --bg:#050816;
  --card:#0d1224;
  --muted:#9399b3;
  --border:#242944;
  --danger:#df4759;
}

/* Global base */
*{
  box-sizing:border-box;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
}

/* Outer page background (match landing page body) */
body{
  margin:0;
  min-height:100vh;
  padding:24px 12px 32px;
  background:#1b1f2f;           /* same as landing page body */
  color:#f5f6ff;
}

/* Inner “card shell” (match landing page .page gradient) */
.shell{
  max-width:1080px;
  margin:0 auto;
  padding:24px 24px 36px;
  border-radius:26px;
  background:radial-gradient(
    circle at top,
    #1a2338 0%,
    #111829 55%,
    #0c1220 100%
  );
  box-shadow:0 22px 80px rgba(0,0,0,0.7);
}

/* Header */
header{
  text-align:center;
  padding:6px 15px 12px;
}
header h1{
  margin:0;
  font-size:28px;
  letter-spacing:1.2px;
  text-transform:uppercase;
}
header h1 span{color:var(--brand-blue);}
header p{
  margin:10px auto 0;
  max-width:820px;
  line-height:1.55;
  font-size:14.5px;
  color:#c4cae8;
}

/* Green hero bar (keep, but use brand green) */
.hero-strip{
  background:linear-gradient(90deg,var(--brand-green),#34c08a);
  color:#ffffff;
  padding:12px 16px;
  text-align:center;
  font-weight:700;
  text-transform:uppercase;
  letter-spacing:0.8px;
  font-size:12px;
  box-shadow:0 8px 20px rgba(0,0,0,0.55);
  max-width:1030px;
  margin:4px auto 12px;
  border-radius:999px;
}

/* Generic layout / card styles */
.container{max-width:1030px;margin:20px auto 0;padding:0 15px}

.card{
  background:var(--card);
  border-radius:16px;
  padding:18px 18px 16px;
  margin-bottom:16px;
  box-shadow:0 14px 32px rgba(0,0,0,0.6);
  border:1px solid var(--border);
}
.card h2{margin:0 0 10px;font-size:18px;}
.small{font-size:12px;color:var(--muted);line-height:1.5}

.grid{display:grid;gap:14px}
@media(min-width:820px){.grid-2{grid-template-columns:repeat(2,minmax(0,1fr))}}

label{
  display:block;
  font-size:13.5px;
  font-weight:700;
  margin-bottom:6px;
  color:#e3e6ff;
}
input[type="text"],
input[type="email"],
input[type="number"],
select,
textarea{
  width:100%;
  padding:8px 10px;
  border-radius:9px;
  border:1px solid var(--border);
  font-size:14px;
  background:#050814;
  color:#f5f6ff;
}
select{background:#050814;}
textarea{min-height:100px;resize:vertical}
input::placeholder,
textarea::placeholder{color:#5e648b;}

.hint{font-size:12px;color:var(--muted);margin-top:4px}

/* Buttons – match landing page CTA feel */
.btn{
  border:none;
  background:var(--brand-blue);
  color:#fff;
  padding:10px 16px;
  border-radius:999px;
  font-size:13px;
  font-weight:800;
  cursor:pointer;
  text-transform:uppercase;
  letter-spacing:0.6px;
  box-shadow:0 10px 26px rgba(2,12,54,0.7);
  transition:transform 0.12s ease,box-shadow 0.12s ease,filter 0.12s ease;
}
.btn:hover{
  filter:brightness(1.06);
  transform:translateY(-1px);
  box-shadow:0 14px 36px rgba(2,12,54,0.85);
}
.btn.secondary{
  background:#30364f;
  margin-left:8px;
  box-shadow:none;
}

/* Mode toggle */
.mode-toggle{display:flex;gap:18px;align-items:center;flex-wrap:wrap}
.mode-toggle label{
  font-weight:600;
  margin:0;
  display:flex;
  gap:8px;
  align-items:center;
  font-size:13px;
  color:#e3e6ff;
}
.mode-toggle input{accent-color:var(--brand-green);}

/* Question “pill” containers (portfolio) */
.pill{
  border:1px solid var(--border);
  border-radius:14px;
  padding:14px;
  background:#050814;
}
.pill h3{
  margin:0 0 8px;
  font-size:14px;
  text-transform:uppercase;
  letter-spacing:0.6px;
  color:#d5daf5;
}
.opt-row{
  display:grid;
  grid-template-columns:1fr 160px;
  gap:12px;
  align-items:center;
  padding:8px 0;
  border-top:1px dashed #222842;
}
.opt-row:first-of-type{border-top:none}
.opt-label{font-size:13px;line-height:1.35;color:#e3e6ff}
.opt-input{display:flex;gap:8px;align-items:center;justify-content:flex-end}
.opt-input span{font-size:12px;color:var(--muted);white-space:nowrap}
.opt-input input{
  width:110px;
  text-align:right;
  background:#050814;
  color:#f5f6ff;
  border:1px solid var(--border);
  border-radius:8px;
}
.totals-line{margin-top:10px;font-size:12px;color:var(--muted)}
.warn{color:#ff9ba8;font-weight:700}
.ok{color:#7ce9b4;font-weight:700}

/* RESULTS – styled like landing hero snapshot card */
.results-banner{
  background:radial-gradient(circle at top,#1c2245 0,#0b1020 50%,#050814 100%);
  color:#fff;
  padding:16px;
  border-radius:18px;
  text-align:center;
  border:1px solid rgba(72,86,155,0.8);
  box-shadow:0 14px 40px rgba(2,5,20,0.9);
}
.results-banner h3{margin:0 0 10px;font-size:18px}
.results-row{display:flex;flex-wrap:wrap;gap:12px;justify-content:center}

/* Inner result pills – lined up with hero metric pills */
.result-pill{
  flex:1 1 180px;
  min-width:180px;
  background:rgba(12,13,32,0.9);
  border-radius:12px;
  padding:12px 10px;
  text-align:center;
  border:1px solid #252b49;
}
.result-label{
  font-size:11px;
  text-transform:uppercase;
  color:#bfbff3;
  letter-spacing:0.6px;
}
.result-value{
  margin-top:6px;
  font-size:22px;
  font-weight:900;
  color:#e0ecff;
}
.badge{
  display:inline-block;
  margin-top:8px;
  padding:4px 10px;
  border-radius:999px;
  font-size:11px;
  font-weight:800;
}
.b-low{background:#d4f5d4;color:#176b2c}      /* green */
.b-med{background:#fff2c6;color:#8a5b00}     /* yellow */
.b-high{background:#ffd3d3;color:#a10000}    /* red */

.pill-header{
  font-weight:900;
  font-size:12px;
  text-transform:uppercase;
  letter-spacing:0.6px;
  color:#e3e6ff;
  margin-bottom:6px;
}
.big-impact{font-size:15px;font-weight:900;margin-bottom:4px}
.big-impact span{font-weight:950}

/* Text in results cards */
#valueSummary,
#profileSummary,
#rateNarrative{
  color:#d5daf5;
}

/* Footer */
footer{
  text-align:center;
  font-size:12px;
  color:#8b92b6;
  padding:20px 10px 0;
}

/* Small footnote under shell */
.footnote{
  text-align:center;
  font-size:11px;
  color:#777;
  margin-top:8px;
  opacity:0.78;
}
</style>
</head>

<body>
<div class="shell">
  <header>
    <h1><span>VOL Health™</span> Volatility Index</h1>
    <p>
      StaffHealth + Accushield Verified = VOL Health™. Directional diagnostic that scores the
      Trinity of Volatility, Operations &amp; Labor across 10 drivers — census, OT, PBJ,
      survey exposure, reimbursement, reputation, and leadership bandwidth. Designed for a
      single building or an entire portfolio.
    </p>
  </header>

  <div class="hero-strip">
    StaffHealth + Accushield Verified = VOL Health™ — The Trinity of Volatility, Operations &amp; Labor
  </div>

  <div class="container">

    <div class="card">
      <h2>1. Select Mode</h2>
      <div class="mode-toggle">
        <label><input type="radio" name="mode" value="single" checked> Single Community Mode (ED / building-level)</label>
        <label><input type="radio" name="mode" value="portfolio"> Portfolio Mode (VP Ops / portfolio roll-up)</label>
      </div>
      <div class="hint" style="margin-top:8px;">
        Portfolio Mode lets executives estimate how many communities sit in each answer option for each question — 
        no need to run 20 buildings one-by-one.
      </div>
    </div>

    <div class="card">
      <h2>2. Snapshot</h2>
      <div class="grid grid-2">
        <div>
          <label for="communityType">Primary Care Level (dominant)</label>
          <select id="communityType">
            <option value="al_mc" selected>Assisted Living / Memory Care</option>
            <option value="snf">Skilled Nursing / Rehab (PDPM)</option>
            <option value="mixed">Mixed Campus (AL/MC + SNF)</option>
          </select>
          <div class="hint">Used to tailor PDPM / reimbursement relevance.</div>
        </div>
        <div>
          <label for="state">State / Region (optional)</label>
          <input id="state" type="text" placeholder="TX, GA, FL, etc." />
          <div class="hint">Optional context for follow-up discussion.</div>
        </div>
      </div>
    </div>

    <!-- SINGLE MODE -->
    <div class="card" id="singleSection">
      <h2>3. Single Community Risk Profile</h2>
      <p class="small" style="margin-bottom:12px;">
        Choose the option that best fits today. If you’re not sure, select <b>Unknown / Not sure</b> — 
        lack of visibility is itself a risk.
      </p>

      <div class="grid grid-2">
        <div>
          <label for="q1">Census stability &amp; move-in / move-out patterns</label>
          <select id="q1">
            <option value="low">Generally stable, rarely delayed</option>
            <option value="med">Some seasonal swings or occasional delays</option>
            <option value="high">Frequent delays, hard to keep census steady</option>
            <option value="unk">Unknown / Not sure</option>
          </select>
        </div>

        <div>
          <label for="q2">Acuity shifts &amp; ability to flex staffing</label>
          <select id="q2">
            <option value="low">Acuity fairly stable, model flexes well</option>
            <option value="med">Occasional spikes strain the team</option>
            <option value="high">Frequent acuity spikes; team constantly stretched</option>
            <option value="unk">Unknown / Not sure</option>
          </select>
        </div>

        <div>
          <label for="q3">Labor model &amp; overtime / call-out pressure</label>
          <select id="q3">
            <option value="low">Low (0–20 OT hours/month; call-outs manageable)</option>
            <option value="med">Moderate (20–60 OT hours/month or frequent scrambling)</option>
            <option value="high">High (60+ OT hours/month; daily scrambling / heavy OT)</option>
            <option value="unk">Unknown / Not sure</option>
          </select>
          <div class="hint">Overtime ranges are monthly, across roles.</div>
        </div>

        <div>
          <label for="q4">Survey / regulatory comfort level</label>
          <select id="q4">
            <option value="low">Clean recent history, few staffing concerns</option>
            <option value="med">Some tags or close calls tied to staffing</option>
            <option value="high">Significant survey risk or recent citations</option>
            <option value="unk">Unknown / Not sure</option>
          </select>
        </div>

        <!-- Q5 is now PBJ -->
        <div>
          <label for="q5">PBJ accuracy &amp; Five-Star staffing confidence</label>
          <select id="q5">
            <option value="low">PBJ clean; confident in staffing data</option>
            <option value="med">Some corrections or PBJ-related anxiety</option>
            <option value="high">Frequent corrections, dips, or staffing-star concerns</option>
            <option value="unk">Unknown / Not sure</option>
          </select>
        </div>

        <div>
          <label for="q6">Liability exposure (falls, med errors, incidents)</label>
          <select id="q6">
            <option value="low">Incidents infrequent and well managed</option>
            <option value="med">Moderate incident volume with some staffing link</option>
            <option value="high">High incident volume or recent severe events</option>
            <option value="unk">Unknown / Not sure</option>
          </select>
        </div>

        <div>
          <label for="q7">Reputation &amp; referral velocity</label>
          <select id="q7">
            <option value="low">Strong reviews and referral relationships</option>
            <option value="med">Mixed reviews or stalled referrals</option>
            <option value="high">Negative staffing-related reviews or referral pullback</option>
            <option value="unk">Unknown / Not sure</option>
          </select>
        </div>

        <div>
          <label for="q8">Leadership bandwidth (ED/DON time spent on staffing)</label>
          <select id="q8">
            <option value="low">Staffing rarely hijacks leadership time</option>
            <option value="med">Staffing issues consume weekly time blocks</option>
            <option value="high">Leaders feel constantly pulled into staffing fires</option>
            <option value="unk">Unknown / Not sure</option>
          </select>
        </div>

        <div>
          <label for="q9">Corporate standardization (partners &amp; credentialing)</label>
          <select id="q9">
            <option value="low">Single, well-aligned partner &amp; clear process</option>
            <option value="med">Several partners with some variation</option>
            <option value="high">Many partners; processes and quality vary widely</option>
            <option value="unk">Unknown / Not sure</option>
          </select>
        </div>

        <!-- Q10 is now PDPM + clarifier -->
        <div>
          <label for="q10">Reimbursement &amp; documentation (for SNF/PDPM beds)</label>
          <select id="q10">
            <option value="low">Documentation strong; denials are rare</option>
            <option value="med">Occasional denials or missed skilled minutes</option>
            <option value="high">Frequent corrections, denials, or missed minutes</option>
            <option value="unk">Unknown / Not sure / Not applicable</option>
          </select>
          <div class="hint">
            This PDPM / reimbursement layer primarily applies to SNF / Rehab / Mixed campuses. For AL/MC-only buildings,
            the model automatically dials down its impact under the hood.
          </div>
        </div>
      </div>

      <div style="margin-top:16px;">
        <label for="usageLevel">If you used StaffHealth as an elasticity layer, how broadly would you expect to use us?</label>
        <select id="usageLevel" style="max-width:380px;">
          <option value="conservative">Conservative (weekends, true pain points only)</option>
          <option value="moderate" selected>Moderate (weekends + select dayparts)</option>
          <option value="aggressive">Strategic (full elasticity model across the building)</option>
        </select>
        <div class="hint">This adjusts the projected stability gain (risk reduction).</div>
      </div>

      <div style="margin-top:18px;">
        <h3 style="margin:0 0 8px;font-size:15px;">Rate &amp; Shifts Snapshot (Optional)</h3>
        <p class="small">
          Add a simple comparison rate and estimated <b>StaffHealth shifts per month</b> if you want the tool to incorporate direct
          rate economics. We’ll convert shifts × 8 hours behind the scenes. Leave blank to run a pure volatility/risk view.
        </p>
        <div class="grid grid-2">
          <div>
            <label for="compareRate">Comparison hourly / blended rate ($/hr)</label>
            <input id="compareRate" type="number" step="0.01" placeholder="e.g., 28.00" />
          </div>
          <div>
            <label for="staffRate">StaffHealth proposed hourly / blended rate ($/hr)</label>
            <input id="staffRate" type="number" step="0.01" placeholder="e.g., 27.00" />
          </div>
          <div>
            <label for="shiftsMonth"
                   title="For this prototype, 1 shift = 8 hours (typical AL/MC staffing pattern).">
              Estimated shifts per month through StaffHealth (8 hrs = standard shift)
            </label>
            <input id="shiftsMonth" type="number" step="1" placeholder="e.g., 12 (weekends + pain shifts)" />
          </div>
        </div>
      </div>
    </div>

    <!-- PORTFOLIO MODE -->
    <div class="card" id="portfolioSection" style="display:none;">
      <h2>3. Portfolio Risk Profile (All Communities)</h2>
      <p class="small" style="margin-bottom:10px;">
        For each question, enter how many communities in your portfolio match each option. This creates a portfolio-level view without running the tool community-by-community.
      </p>

      <div class="grid grid-2" style="margin-bottom:10px;">
        <div>
          <label for="portfolioN">Portfolio size (optional)</label>
          <input id="portfolioN" type="number" min="0" placeholder="e.g., 18" />
          <div class="hint">If provided, we’ll flag questions where your counts don’t sum to N (sanity check only).</div>
        </div>
        <div>
          <label for="usageLevelPortfolio">Elasticity adoption level (portfolio)</label>
          <select id="usageLevelPortfolio">
            <option value="conservative">Conservative (weekends / true pain points)</option>
            <option value="moderate" selected>Moderate (weekends + select dayparts)</option>
            <option value="aggressive">Strategic (broad portfolio elasticity)</option>
          </select>
          <div class="hint">Adjusts projected risk reduction across the portfolio.</div>
        </div>
      </div>

      <!-- Question blocks (portfolio) -->
      <div class="pill" data-q="q1">
        <h3>1) Census stability &amp; move-in / move-out patterns</h3>
        <div class="opt-row">
          <div class="opt-label">Generally stable, rarely delayed</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q1_low"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Some seasonal swings or occasional delays</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q1_med"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Frequent delays, hard to keep census steady</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q1_high"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Unknown / Not sure</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q1_unk"></div>
        </div>
        <div class="totals-line" id="sum_q1"></div>
      </div>

      <div class="pill" data-q="q2" style="margin-top:12px;">
        <h3>2) Acuity shifts &amp; ability to flex staffing</h3>
        <div class="opt-row">
          <div class="opt-label">Acuity fairly stable, model flexes well</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q2_low"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Occasional spikes strain the team</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q2_med"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Frequent acuity spikes; team constantly stretched</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q2_high"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Unknown / Not sure</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q2_unk"></div>
        </div>
        <div class="totals-line" id="sum_q2"></div>
      </div>

      <div class="pill" data-q="q3" style="margin-top:12px;">
        <h3>3) Labor model &amp; overtime / call-out pressure</h3>
        <div class="opt-row">
          <div class="opt-label">Low (0–20 OT hours/month; call-outs manageable)</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q3_low"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Moderate (20–60 OT hours/month or frequent scrambling)</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q3_med"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">High (60+ OT hours/month; daily scrambling / heavy OT)</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q3_high"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Unknown / Not sure</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q3_unk"></div>
        </div>
        <div class="totals-line" id="sum_q3"></div>
      </div>

      <div class="pill" data-q="q4" style="margin-top:12px;">
        <h3>4) Survey / regulatory comfort level</h3>
        <div class="opt-row">
          <div class="opt-label">Clean recent history, few staffing concerns</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q4_low"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Some tags or close calls tied to staffing</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q4_med"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Significant survey risk or recent citations</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q4_high"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Unknown / Not sure</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q4_unk"></div>
        </div>
        <div class="totals-line" id="sum_q4"></div>
      </div>

      <!-- Q5 is now PBJ in portfolio -->
      <div class="pill" data-q="q5" style="margin-top:12px;">
        <h3>5) PBJ accuracy &amp; Five-Star staffing confidence</h3>
        <div class="opt-row">
          <div class="opt-label">PBJ clean; confident in staffing data</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q5_low"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Some corrections or PBJ-related anxiety</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q5_med"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Frequent corrections, dips, or staffing-star concerns</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q5_high"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Unknown / Not sure</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q5_unk"></div>
        </div>
        <div class="totals-line" id="sum_q5"></div>
      </div>

      <div class="pill" data-q="q6" style="margin-top:12px;">
        <h3>6) Liability exposure (falls, med errors, incidents)</h3>
        <div class="opt-row">
          <div class="opt-label">Incidents infrequent and well managed</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q6_low"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Moderate incident volume with some staffing link</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q6_med"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">High incident volume or recent severe events</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q6_high"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Unknown / Not sure</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q6_unk"></div>
        </div>
        <div class="totals-line" id="sum_q6"></div>
      </div>

      <div class="pill" data-q="q7" style="margin-top:12px;">
        <h3>7) Reputation &amp; referral velocity</h3>
        <div class="opt-row">
          <div class="opt-label">Strong reviews and referral relationships</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q7_low"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Mixed reviews or stalled referrals</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q7_med"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Negative staffing-related reviews or referral pullback</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q7_high"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Unknown / Not sure</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q7_unk"></div>
        </div>
        <div class="totals-line" id="sum_q7"></div>
      </div>

      <div class="pill" data-q="q8" style="margin-top:12px;">
        <h3>8) Leadership bandwidth (ED/DON time spent on staffing)</h3>
        <div class="opt-row">
          <div class="opt-label">Staffing rarely hijacks leadership time</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q8_low"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Staffing issues consume weekly time blocks</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q8_med"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Leaders feel constantly pulled into staffing fires</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q8_high"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Unknown / Not sure</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q8_unk"></div>
        </div>
        <div class="totals-line" id="sum_q8"></div>
      </div>

      <div class="pill" data-q="q9" style="margin-top:12px;">
        <h3>9) Corporate standardization (partners &amp; credentialing)</h3>
        <div class="opt-row">
          <div class="opt-label">Single, well-aligned partner &amp; clear process</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q9_low"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Several partners with some variation</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q9_med"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Many partners; processes and quality vary widely</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q9_high"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Unknown / Not sure</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q9_unk"></div>
        </div>
        <div class="totals-line" id="sum_q9"></div>
      </div>

      <!-- Q10 is now PDPM in portfolio -->
      <div class="pill" data-q="q10" style="margin-top:12px;">
        <h3>10) Reimbursement &amp; documentation (for SNF/PDPM beds)</h3>
        <div class="opt-row">
          <div class="opt-label">Documentation strong; denials are rare</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q10_low"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Occasional denials or missed skilled minutes</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q10_med"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Frequent corrections, denials, or missed minutes</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q10_high"></div>
        </div>
        <div class="opt-row">
          <div class="opt-label">Unknown / Not sure / Not applicable</div>
          <div class="opt-input"><span># communities</span><input type="number" min="0" id="p_q10_unk"></div>
        </div>
        <div class="totals-line" id="sum_q10"></div>
      </div>

    </div>

    <div class="card">
      <h2>4. Run the VOL Health Index</h2>
      <p class="small">
        Click Calculate to see your VOL Health stability score, projected stability gain, and illustrative annual economics.
      </p>
      <button class="btn" id="calcBtn">Calculate VOL Health Score</button>
      <button class="btn secondary" id="resetBtn" type="button">Reset</button>
    </div>

    <div class="card" id="resultsCard" style="display:none;">
      <div class="results-banner">
        <h3>Your VOL Health Snapshot</h3>
        <div class="results-row">
          <div class="result-pill">
            <div class="result-label" id="riskLabel">Baseline VOL Health Stability (Current State)</div>
            <div class="result-value" id="riskScoreLabel">0 / 100</div>
            <div id="riskBadge" class="badge"></div>

            <div class="small" style="color:#bfbfbf; margin-top:4px;">
              Higher is better — directional stability signal across Volatility, Operations &amp; Labor.
            </div>
          </div>
          <div class="result-pill">
            <div class="result-label">Projected Stability Gain (Elasticity Impact)</div>
            <div class="result-value" id="impactScoreLabel">0 pts</div>
            <div class="small" style="color:#bfbfbf;">
              How many stability points a VOL Health model powered by StaffHealth + Accushield Verified could realistically add.
            </div>
          </div>
          <div class="result-pill">
            <div class="result-label">Stabilized VOL Health Score (Post-Elasticity)</div>
            <div class="result-value" id="finalScoreLabel">0 / 100</div>
            <div class="small" style="color:#bfbfbf;">
              Higher is better — post-elasticity stability profile.
            </div>
          </div>
        </div>
      </div>

      <p class="small" id="modeSummary" style="margin-top:12px;">
        In Single Community Mode, the VOL Health Volatility Index reflects one building’s volatility, overtime, PBJ exposure,
        and leadership strain. It is directional, not a survey or audit.
      </p>

      <div class="grid grid-2" style="margin-top:12px;">
        <div>
          <div class="pill-header">Estimated Annual Economics at Stake (Illustrative)</div>
          <div id="valueSummary">—</div>
        </div>
        <div>
          <div class="pill-header">Quick Read on Staffing Health</div>
          <div id="profileSummary" class="small" style="font-size:13px;">—</div>
        </div>
      </div>

      <div style="margin-top:12px;">
        <div class="pill-header">Rate &amp; Model Narrative</div>
        <div id="rateNarrative" class="small" style="font-size:13px;">—</div>
      </div>
    </div>

    <div class="card" id="followupCard" style="display:none;">
      <h2>5. Copyable Summary (Optional)</h2>
      <p class="small">Copy results into an email, CRM note, or text.</p>
      <label for="resultsText">Copyable VOL Health Summary</label>
      <textarea id="resultsText"></textarea>
      <button class="btn" type="button" id="copyBtn" style="margin-top:10px;">Copy Results</button>
    </div>

    <footer>StaffHealth + Accushield Verified — VOL Health™ Volatility Index — Prototype</footer>
  </div>
</div>

<div class="footnote">
  Prototype Model v0.5 — VOL Health framework developed independently by Hudson Keel
  for internal evaluation and strategic insight testing.
  Not a final or officially endorsed StaffHealth or Accushield Verified product.
</div>

<script>
const WEIGHTS = { q1:12, q2:10, q3:14, q4:12, q5:10, q6:12, q7:8, q8:10, q9:6, q10:10 };

function getMode(){
  const el=document.querySelector('input[name="mode"]:checked');
  return el?el.value:"single";
}

function riskFromAnswer(val){
  switch(val){
    case "low": return 0.2;
    case "med": return 0.5;
    case "high": return 0.8;
    case "unk": return 1.0;
    default: return 0.5;
  }
}

// classify based on STABILITY (higher = better)
function classify(stabilityScore){
  if(stabilityScore < 40) return {label:"Low Stability (High Volatility)", cls:"b-high"};
  if(stabilityScore < 70) return {label:"Mixed Stability", cls:"b-med"};
  return {label:"Higher Stability (Lower Volatility)", cls:"b-low"};
}

function usageImpactPct(val){
  if(val==="conservative") return 0.35;
  if(val==="aggressive") return 0.65;
  return 0.50; // moderate default
}

function intVal(id){
  const v = parseInt((document.getElementById(id)?.value || "0"), 10);
  return isNaN(v) ? 0 : v;
}

function sumPortfolioRow(qKey){
  const low=intVal(`p_${qKey}_low`);
  const med=intVal(`p_${qKey}_med`);
  const high=intVal(`p_${qKey}_high`);
  const unk=intVal(`p_${qKey}_unk`);
  return {low,med,high,unk,total: low+med+high+unk};
}

function updateRowSums(){
  const N = intVal("portfolioN");
  for(let i=1;i<=10;i++){
    const qKey="q"+i;
    const s = sumPortfolioRow(qKey);
    const el = document.getElementById("sum_"+qKey);
    if(!el) continue;

    if(s.total===0){
      el.innerHTML = `<span class="small">Total entered: 0 (optional)</span>`;
      continue;
    }

    if(N>0){
      if(s.total===N){
        el.innerHTML = `<span class="ok">Total entered: ${s.total} (matches portfolio size)</span>`;
      }else{
        el.innerHTML = `<span class="warn">Total entered: ${s.total} (does not match portfolio size ${N})</span>`;
      }
    }else{
      el.innerHTML = `<span class="small">Total entered: ${s.total}</span>`;
    }
  }
}

// Live sum updates in portfolio mode
[
  "portfolioN",
  "p_q1_low","p_q1_med","p_q1_high","p_q1_unk",
  "p_q2_low","p_q2_med","p_q2_high","p_q2_unk",
  "p_q3_low","p_q3_med","p_q3_high","p_q3_unk",
  "p_q4_low","p_q4_med","p_q4_high","p_q4_unk",
  "p_q5_low","p_q5_med","p_q5_high","p_q5_unk",
  "p_q6_low","p_q6_med","p_q6_high","p_q6_unk",
  "p_q7_low","p_q7_med","p_q7_high","p_q7_unk",
  "p_q8_low","p_q8_med","p_q8_high","p_q8_unk",
  "p_q9_low","p_q9_med","p_q9_high","p_q9_unk",
  "p_q10_low","p_q10_med","p_q10_high","p_q10_unk"
].forEach(id=>{
  const el=document.getElementById(id);
  if(el) el.addEventListener("input", updateRowSums);
});

// Toggle behavior
document.querySelectorAll('input[name="mode"]').forEach(r=>{
  r.addEventListener("change", ()=>{
    const mode=getMode();
    document.getElementById("singleSection").style.display = mode==="single" ? "block" : "none";
    document.getElementById("portfolioSection").style.display = mode==="portfolio" ? "block" : "none";

    document.getElementById("riskLabel").textContent =
      mode==="single"
        ? "Baseline VOL Health Stability (Current State)"
        : "Average VOL Health Stability per Community (Portfolio)";

    document.getElementById("modeSummary").textContent =
      mode==="single"
        ? "In Single Community Mode, the VOL Health Volatility Index reflects one building’s volatility, overtime, PBJ exposure, and leadership strain. It is directional, not a survey or audit."
        : "In Portfolio Mode, the VOL Health Volatility Index reflects an average per-community risk/stability profile based on how many communities fit each answer option for each factor.";

    if(mode==="portfolio") updateRowSums();
  });
});

document.getElementById("calcBtn").addEventListener("click", ()=>{
  const mode=getMode();
  const communityType=document.getElementById("communityType").value;
  const state=document.getElementById("state").value || "N/A";

  let weights={...WEIGHTS};
  // AL/MC: PDPM layer (now q10) is not relevant, so we zero its weight
  if(communityType==="al_mc") weights.q10 = 0;

  let riskScore100=0, finalRiskScore=0;
  let stabilityPre=0, impactScore=0, finalScore=0;
  let baselineLow=0, baselineHigh=0, stabilizedLow=0, stabilizedHigh=0;
  let netImpact=0, directAnnual=0, hasRates=false;
  let usedN=1;
  let shiftsMonth=0, hoursMonth=0;

  if(mode==="single"){
    let weightedRiskSum=0, weightTotal=0;

    for(let i=1;i<=10;i++){
      const key="q"+i;
      const w=weights[key];
      if(w===0) continue;
      const ans=document.getElementById(key).value;
      const r=riskFromAnswer(ans); // 0–1 risk
      weightedRiskSum += (r*10) * w; // 0–10 scaled
      weightTotal += w;
    }

    const riskScore0to10 = weightTotal===0 ? 0 : (weightedRiskSum/weightTotal);
    riskScore100 = Math.round(riskScore0to10*10);   // 0–100 risk (higher=worse)

    const usage=document.getElementById("usageLevel").value;
    const impactPct=usageImpactPct(usage);

    // Impact is based on RISK, not stability.
    impactScore = Math.round(riskScore100 * impactPct);   // risk points removed = stability points gained
    finalRiskScore = Math.max(0, riskScore100 - impactScore);

    // Econ ranges still scale off risk (volatility)
    baselineLow = Math.round(riskScore100*3000/1000)*1000;
    baselineHigh = Math.round(riskScore100*6000/1000)*1000;
    stabilizedLow = Math.round(impactScore*3000/1000)*1000;
    stabilizedHigh = Math.round(impactScore*6000/1000)*1000;

    // Optional rates (shift-based input → hours)
    const compareRate = parseFloat(document.getElementById("compareRate").value);
    const staffRate   = parseFloat(document.getElementById("staffRate").value);
    shiftsMonth       = parseFloat(document.getElementById("shiftsMonth").value);
    hoursMonth        = !isNaN(shiftsMonth) && shiftsMonth > 0 ? shiftsMonth * 8 : NaN; // 8-hr standard shift

    hasRates =
      !isNaN(compareRate) && compareRate > 0 &&
      !isNaN(staffRate)   && staffRate   > 0 &&
      !isNaN(hoursMonth)  && hoursMonth  > 0;

    const stabilizedMid = (stabilizedLow + stabilizedHigh)/2;
    if(hasRates){
      directAnnual = (compareRate - staffRate) * hoursMonth * 12; // + = savings
      netImpact = stabilizedMid + directAnnual;
    }else{
      netImpact = stabilizedMid;
    }
    usedN=1;

  }else{
    // PORTFOLIO MODE — counts next to each option
    let weightedRiskSum=0, weightTotal=0;
    let totalNsum=0, qCount=0;

    for(let i=1;i<=10;i++){
      const key="q"+i;
      const w=weights[key];
      if(w===0) continue;

      const s=sumPortfolioRow(key);
      if(s.total===0) continue;

      const r = (0.2*s.low + 0.5*s.med + 0.8*s.high + 1.0*s.unk) / s.total; // 0–1 risk
      weightedRiskSum += (r*10) * w;
      weightTotal += w;

      totalNsum += s.total;
      qCount++;
    }

    const riskScore0to10 = weightTotal===0 ? 0 : (weightedRiskSum/weightTotal);
    riskScore100 = Math.round(riskScore0to10*10); // 0–100 risk

    const usage=document.getElementById("usageLevelPortfolio").value;
    const impactPct=usageImpactPct(usage);

    impactScore    = Math.round(riskScore100 * impactPct);   // risk points removed per building
    finalRiskScore = Math.max(0, riskScore100 - impactScore);

    // Estimate N as average across questions that were filled
    usedN = qCount>0 ? Math.round(totalNsum/qCount) : 1;

    // Econ ranges per building, then scale by N
    const perLow     = Math.round(riskScore100*3000/1000)*1000;
    const perHigh    = Math.round(riskScore100*6000/1000)*1000;
    const perStabLow = Math.round(impactScore*3000/1000)*1000;
    const perStabHigh= Math.round(impactScore*6000/1000)*1000;

    baselineLow   = perLow * usedN;
    baselineHigh  = perHigh * usedN;
    stabilizedLow = perStabLow * usedN;
    stabilizedHigh= perStabHigh * usedN;

    netImpact = (stabilizedLow + stabilizedHigh)/2;
    hasRates=false;
  }

  // Convert risk-based scores into stability (HIGH = good)
  stabilityPre = Math.max(0, Math.min(100, 100 - riskScore100));
  finalScore   = Math.max(0, Math.min(100, 100 - finalRiskScore));

  // Render results
  document.getElementById("riskScoreLabel").textContent   = `${stabilityPre} / 100`;
  document.getElementById("impactScoreLabel").textContent = `${impactScore} pts`;
  document.getElementById("finalScoreLabel").textContent  = `${finalScore} / 100`;

  const b=classify(stabilityPre);
  const badge=document.getElementById("riskBadge");
  badge.textContent=b.label;
  badge.className=`badge ${b.cls}`;

  // Money summary (use already-computed baselineLow/High, stabilizedLow/High)
  const baselineText = mode==="single"
    ? `Annual economics currently influenced by staffing volatility: <span>$${baselineLow.toLocaleString()}–$${baselineHigh.toLocaleString()}</span>`
    : `Portfolio annual economics currently influenced by staffing volatility (≈${usedN} communities): <span>$${baselineLow.toLocaleString()}–$${baselineHigh.toLocaleString()}</span>`;

  const stabText = mode==="single"
    ? `Illustrative economics a VOL Health model (powered by StaffHealth + Accushield Verified) could help stabilize: <b>$${stabilizedLow.toLocaleString()}–$${stabilizedHigh.toLocaleString()}</b>`
    : `Illustrative economics a VOL Health model (powered by StaffHealth + Accushield Verified) could help stabilize (portfolio): <b>$${stabilizedLow.toLocaleString()}–$${stabilizedHigh.toLocaleString()}</b>`;

  let extra = "";
  if(mode==="single"){
    const compareRate = parseFloat(document.getElementById("compareRate").value);
    const staffRate   = parseFloat(document.getElementById("staffRate").value);
    const shiftsMonthLocal = parseFloat(document.getElementById("shiftsMonth").value);
    const hoursMonthLocal  = !isNaN(shiftsMonthLocal) && shiftsMonthLocal > 0 ? shiftsMonthLocal * 8 : NaN;

    const hasRatesLocal =
      !isNaN(compareRate) && compareRate > 0 &&
      !isNaN(staffRate)   && staffRate   > 0 &&
      !isNaN(hoursMonthLocal)  && hoursMonthLocal  > 0;

    if(hasRatesLocal){
      const directAnnualLocal = (compareRate - staffRate) * hoursMonthLocal * 12;
      const stabilizedMidLocal = (stabilizedLow + stabilizedHigh)/2;
      const netImpactLocal = stabilizedMidLocal + directAnnualLocal;

      const directLabel = directAnnualLocal >= 0 ? "Estimated direct annual savings from rate:" : "Estimated direct annual premium from rate:";
      const netLabel    = netImpactLocal   >= 0 ? "Directional annual net benefit (rate + stability):" : "Directional annual net cost (rate + stability):";

      extra = `<div class="small" style="margin-top:8px;">
<b>${directLabel}</b> $${Math.abs(directAnnualLocal).toLocaleString()}<br/>
<b>${netLabel}</b> $${Math.abs(netImpactLocal).toLocaleString()}<br/>
<span>Based on approximately ${shiftsMonthLocal.toLocaleString()} shifts/month ≈ ${hoursMonthLocal.toLocaleString()} hours/month (8 hrs/shift).</span>
</div>`;
    }else{
      extra = `<div class="small" style="margin-top:8px;">Rate fields were left blank, so this view focuses on volatility and risk rather than hourly pricing.</div>`;
    }
  }else{
    extra = `<div class="small" style="margin-top:8px;">Portfolio Mode uses your distribution of communities across each option for each factor to compute an average risk/stability score per community and a portfolio roll-up.</div>`;
  }

  document.getElementById("valueSummary").innerHTML =
    `<div class="big-impact">${baselineText}</div><div>${stabText}</div>${extra}`;

  // Profile narrative
  let profile="";
  if(stabilityPre < 40){
    profile = (mode==="single")
      ? "Low stability today: volatility, OT, PBJ, and leadership drag are likely creating hidden cost every week. A verified elasticity layer can materially reduce downside risk."
      : "Portfolio trends toward lower stability on average. Multiple buildings likely carry meaningful volatility, OT, and PBJ risk that can be de-risked with a structured elasticity model.";
  }else if(stabilityPre < 70){
    profile = (mode==="single")
      ? "Mixed stability: operations work, but leadership and PBJ are absorbing real strain. A targeted elasticity layer on weekends and pain shifts can relieve pressure and protect survey readiness."
      : "Moderate stability across the portfolio: most buildings function, but leadership capacity and PBJ confidence are at risk if anything shifts. Targeted elasticity deployment across the right cohort can move the average measurably.";
  }else{
    profile = (mode==="single")
      ? "Higher stability today: the building is relatively steady, but there is still real upside in protecting this position as census, acuity, and PBJ expectations keep shifting."
      : "Higher stability on average: portfolio is relatively steady, but protecting this position while shoring up the weaker buildings can unlock meaningful upside and reduce downside surprises.";
  }
  document.getElementById("profileSummary").textContent = profile;

  // Rate narrative
  let rateNarr="";
  if(mode==="portfolio"){
    rateNarr = "This run focuses on volatility and stability at the portfolio level. In follow-up, we can layer in rate cohorts (agency vs OT vs blended) to show how the model behaves financially by building cluster. Core message: volatility and compliance exposure often cost more than the rate line.";
  }else{
    const compareRate = parseFloat(document.getElementById("compareRate").value);
    const staffRate   = parseFloat(document.getElementById("staffRate").value);
    const shiftsMonthLocal = parseFloat(document.getElementById("shiftsMonth").value);
    const hoursMonthLocal  = !isNaN(shiftsMonthLocal) && shiftsMonthLocal > 0 ? shiftsMonthLocal * 8 : NaN;
    const hasRatesLocal =
      !isNaN(compareRate) && compareRate > 0 &&
      !isNaN(staffRate)   && staffRate   > 0 &&
      !isNaN(hoursMonthLocal)  && hoursMonthLocal  > 0;

    if(!hasRatesLocal){
      rateNarr = "No rate inputs were provided, so this run is a pure volatility/stability view. Add rate + shifts to compare direct economics alongside the stability benefit.";
    }else{
      const directAnnualLocal = (compareRate - staffRate) * hoursMonthLocal * 12;
      const stabilizedMidLocal = (stabilizedLow + stabilizedHigh)/2;
      const netImpactLocal = stabilizedMidLocal + directAnnualLocal;

      const premium = staffRate > compareRate + 1;
      const parity  = Math.abs(staffRate-compareRate) <= 1;
      const cheaper = staffRate < compareRate - 1;

      if(cheaper && netImpactLocal>=0){
        rateNarr = "Rate and stability both work in your favor. StaffHealth improves hourly economics and strengthens stability within the VOL Health model — strong pilot profile.";
      }else if(parity && netImpactLocal>=0){
        rateNarr = "Rate parity shifts the conversation to volatility: the upside lives in PBJ, survey readiness, leadership time, and reduced OT churn.";
      }else if(premium && netImpactLocal>=0){
        rateNarr = "Even with a rate premium, the estimated stability benefit outweighs it — trading a known small cost for a larger reduction in volatility and downside risk.";
      }else{
        rateNarr = "On these specific inputs the financial signal is weak. Worth revisiting if hours mix, comparison rate, or volatility picture changes.";
      }
    }
  }
  document.getElementById("rateNarrative").textContent = rateNarr;

  // Copy block
  let copy =
`VOL Health™ Volatility Index – Results

Mode: ${mode==="single" ? "Single Community" : "Portfolio"}
Community Type: ${communityType.toUpperCase()}
State/Region: ${state}

VOL Health Stability Score (Current State): ${stabilityPre} / 100
Projected Stability Gain (Elasticity Impact): ${impactScore} pts
Stabilized VOL Health Score (Post-Elasticity): ${finalScore} / 100

Annual economics influenced by staffing volatility: $${baselineLow.toLocaleString()}–$${baselineHigh.toLocaleString()}
Illustrative economics a VOL Health model (powered by StaffHealth + Accushield Verified) could help stabilize: $${stabilizedLow.toLocaleString()}–$${stabilizedHigh.toLocaleString()}

`;

  if(mode==="portfolio"){
    copy += `Approx. portfolio size used (avg of filled questions): ${usedN}\n`;
  }

  document.getElementById("resultsText").value = copy;

  document.getElementById("resultsCard").style.display="block";
  document.getElementById("followupCard").style.display="block";
  document.getElementById("resultsCard").scrollIntoView({behavior:"smooth"});
});

document.getElementById("resetBtn").addEventListener("click", ()=>{
  // single resets
  for(let i=1;i<=10;i++){
    const s=document.getElementById("q"+i);
    if(s) s.selectedIndex=0;
  }
  document.getElementById("usageLevel").value="moderate";
  ["compareRate","staffRate","shiftsMonth","state"].forEach(id=>{
    const el=document.getElementById(id);
    if(el) el.value="";
  });

  // portfolio resets
  document.getElementById("portfolioN").value="";
  document.getElementById("usageLevelPortfolio").value="moderate";
  for(let i=1;i<=10;i++){
    ["low","med","high","unk"].forEach(b=>{
      const el=document.getElementById(`p_q${i}_${b}`);
      if(el) el.value="";
    });
    const sumEl=document.getElementById("sum_q"+i);
    if(sumEl) sumEl.textContent="";
  }

  document.getElementById("resultsCard").style.display="none";
  document.getElementById("followupCard").style.display="none";
});

document.getElementById("copyBtn").addEventListener("click", function(){
  const ta=document.getElementById("resultsText");
  ta.select();
  ta.setSelectionRange(0,99999);
  try{
    document.execCommand("copy");
    this.textContent="Copied!";
    setTimeout(()=>this.textContent="Copy Results",1200);
  }catch(e){
    alert("Copy failed. Please select and copy manually.");
  }
});

// initialize sums if they switch modes quickly
updateRowSums();
</script>
</body>
</html>
